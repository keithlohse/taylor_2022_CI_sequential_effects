PRED<-data.frame(subID=c("s01","s02","s03","s04","s05"), Intercepts=c(coef(raneff_int)$subID[c(1:5),]))
PRED
ggplot(first5, aes(x = year.0, y = rasch_FIM)) +
geom_line(aes(group=subID)) + facet_wrap(~subID, ncol=5)+
geom_point(fill="grey", pch=21, size=2, stroke=1.25) +
scale_x_continuous(name = "Time from Admission (Years)") +
scale_y_continuous(name = "Independence (0-100)",limits=c(0,100))+
geom_abline(aes(intercept=Intercepts, slope=0), col="black", lwd=1, PRED) +
theme_bw() + theme(axis.text=element_text(size=10, colour="black"),
axis.title=element_text(size=10,face="bold")) +
theme(strip.text.x = element_text(size = 10))+ theme(legend.position="none")
raneff_lin_rand<-lmer(rasch_FIM~
# Fixed-effects
1+year.0+
# Random-effects
(1+year.0|subID), data=DATA, REML=FALSE)
summary(raneff_lin_rand)
PRED<-data.frame(subID=c("s01","s02","s03","s04","s05"),
Intercepts=c(coef(raneff_lin_rand)$subID[c(1:5),1]),
Slopes=c(coef(raneff_lin_rand)$subID[c(1:5),2]))
PRED
ggplot(first5, aes(x = year.0, y = rasch_FIM)) +
geom_point(fill="grey", pch=21, size=2, stroke=1.25) +
geom_line(aes(group=subID)) + facet_wrap(~subID, ncol=5)+
scale_x_continuous(name = "Time from Admission (Years)") +
scale_y_continuous(name = "Independence (0-100)",limits=c(0,100))+
geom_abline(aes(intercept=Intercepts, slope=Slopes), col="red", lwd=1, PRED)+
theme_bw() + theme(axis.text=element_text(size=10, colour="black"),
axis.title=element_text(size=10,face="bold")) +
theme(strip.text.x = element_text(size = 10))+ theme(legend.position="none")
raneff_quad_rand<-lmer(rasch_FIM~
# Fixed-effects
1+year.0+I(year.0^2)+
# Random-effects
(1+year.0+I(year.0^2)|subID), data=DATA, REML=FALSE)
summary(raneff_quad_rand)
DATA$quad_pred <- fitted(raneff_quad_rand) # Save model predictions to data frame
first5<-DATA[c(1:90),] # Second, we'll make a smaller dataset with the predictions for these 10:
ggplot(first5, aes(x = year.0, y = rasch_FIM)) +
geom_line(aes(group=subID)) + facet_wrap(~subID, ncol=5)+
geom_point(fill="grey", pch=21, size=2, stroke=1.25) +
scale_x_continuous(name = "Time from Admission (Years)") +
scale_y_continuous(name = "Independence (0-100)",limits=c(0,100))+
geom_line(aes(y=quad_pred), lwd=1, col="dodgerblue") +
theme_bw() + theme(axis.text=element_text(size=10, colour="black"),
axis.title=element_text(size=10,face="bold")) +
theme(strip.text.x = element_text(size = 10))+ theme(legend.position="none")
ggplot(DATA, aes(x = year.0, y = rasch_FIM)) +
geom_line(aes(group=subID)) +
geom_point(aes(fill=as.factor(subID)), pch=21, size=1, stroke=1) +
facet_wrap(~AIS_grade) +
scale_x_continuous(name = "Time from Admission (Years)", breaks=c(0,0.5,1,1.5), limits=c(0,1.5)) +
scale_y_continuous(name = "Independence (0-100)",limits=c(0,100)) +
theme_bw() + theme(axis.text.x=element_text(size=10, colour="black"),
axis.text.y=element_text(size=10, colour="black"),
axis.title=element_text(size=12,face="bold")) +
theme(strip.text.x = element_text(size = 12))+ theme(legend.position="none")
raneff_lin_fixed<-lmer(rasch_FIM~
# Fixed-effects
1+Time+
# Random-effects
(1|subID), data=DATA, REML=FALSE)
raneff_lin_fixed<-lmer(rasch_FIM~
# Fixed-effects
1+year.0+
# Random-effects
(1|subID), data=DATA, REML=FALSE)
first5<-DATA[c(1:90),] # Second, we'll make a smaller dataset with the predictions for these 10:
PRED<-data.frame(subID=c("s01","s02","s03","s04","s05"), Intercepts=c(coef(raneff_lin_fixed)$subID[c(1:5),]))
PRED
i
raneff_lin_fixed)$subID[c(1:5),]
raneff_lin_fixed$subID[c(1:5),]
raneff_lin_fixed
first5<-DATA[c(1:90),] # Second, we'll make a smaller dataset with the predictions for these 10:
PRED<-data.frame(subID=c("s01","s02","s03","s04","s05"),
Intercepts=c(coef(raneff_lin_fixed)$subID[c(1:5),1]),
Slopes=c(coef(raneff_lin_fixed)$subID[c(1:5),2]))
PRED
ggplot(first5, aes(x = year.0, y = rasch_FIM)) +
geom_line(aes(group=subID)) + facet_wrap(~subID, ncol=5)+
geom_point(fill="grey", pch=21, size=2, stroke=1.25) +
scale_x_continuous(name = "Time from Admission (Years)") +
scale_y_continuous(name = "Independence (0-100)",limits=c(0,100))+
geom_abline(aes(intercept=Intercepts, slope=Slopes), col="black", lwd=1, PRED) +
theme_bw() + theme(axis.text=element_text(size=10, colour="black"),
axis.title=element_text(size=10,face="bold")) +
theme(strip.text.x = element_text(size = 10))+ theme(legend.position="none")
PRED
raneff_quad_rand<-lmer(rasch_FIM~
# Fixed-effects
1+year.0+I(year.0^2)+
# Random-effects
(1+year.0+I(year.0^2)|subID), data=DATA, REML=FALSE)
summary(raneff_quad_rand)
raneff_quad_rand_b<-lmer(rasch_FIM~
# Fixed-effects
1+year.0+I(year.0^2)+
# Random-effects
(1+year.0|subID), data=DATA, REML=FALSE)
summary(raneff_quad_rand_b)
anova(raneff_quad_rand, raneff_quad_rand_b)
# Negative Exponential Model ----
ggplot(DATA, aes(x = year, y = rasch_FIM)) +
geom_line(aes(group=subID), col="grey") +
stat_smooth(method="loess", col="black", lwd=1.5, se=FALSE)+
scale_x_continuous(name = "Time from Admission (Years)") +
scale_y_continuous(name = "Rasch-Scaled FIM Score (0-100)",limits=c(0,100)) +
theme_bw() +
theme(axis.text=element_text(size=14, colour="black"),
axis.title=element_text(size=14,face="bold")) +
theme(strip.text.x = element_text(size = 14))+ theme(legend.position="none")
# Negative Exponential Model ----
ggplot(DATA, aes(x = year.0, y = rasch_FIM)) +
geom_line(aes(group=subID), col="grey") +
stat_smooth(method="loess", col="black", lwd=1.5, se=FALSE)+
scale_x_continuous(name = "Time from Admission (Years)") +
scale_y_continuous(name = "Rasch-Scaled FIM Score (0-100)",limits=c(0,100)) +
theme_bw() +
theme(axis.text=element_text(size=14, colour="black"),
axis.title=element_text(size=14,face="bold")) +
theme(strip.text.x = element_text(size = 14))+ theme(legend.position="none")
library(nlme)
set.seed(100)
neg_exp_rand_mod <- nlme(rasch_FIM ~ b_1i +
(b_2)*(exp(b_3i * year)),
data = DATA,
fixed = b_1i + b_2 + b_3i ~ 1,
random = list(b_1i ~ 1, b_3i ~1),
groups = ~ subID,
start = c(80, -70, -1),
na.action = na.omit)
neg_exp_rand_mod <- nlme(rasch_FIM ~ b_1i +
(b_2)*(exp(b_3i * year.0)),
data = DATA,
fixed = b_1i + b_2 + b_3i ~ 1,
random = list(b_1i ~ 1, b_3i ~1),
groups = ~ subID,
start = c(80, -70, -1),
na.action = na.omit)
summary(neg_exp_rand_mod)
neg_exp_rand_mod <- nlme(rasch_FIM ~ b_1i +
(b_2i)*(exp(b_3i * year.0)),
data = DATA,
fixed = b_1i + b_2i + b_3i ~ 1,
random = list(b_1i ~ 1, b_2i ~ 1, b_3i ~1),
groups = ~ subID,
start = c(80, -70, -1),
na.action = na.omit)
summary(neg_exp_rand_mod)
# Negative Exponential Model ----
ggplot(DATA, aes(x = year.0, y = rasch_FIM)) +
geom_line(aes(group=subID), col="grey") +
stat_smooth(method="lm", formula=y~e^(X), col="black", lwd=1.5, se=FALSE)+
scale_x_continuous(name = "Time from Admission (Years)") +
scale_y_continuous(name = "Rasch-Scaled FIM Score (0-100)",limits=c(0,100)) +
theme_bw() +
theme(axis.text=element_text(size=14, colour="black"),
axis.title=element_text(size=14,face="bold")) +
theme(strip.text.x = element_text(size = 14))+ theme(legend.position="none")
# Negative Exponential Model ----
ggplot(DATA, aes(x = year.0, y = rasch_FIM)) +
geom_line(aes(group=subID), col="grey") +
stat_smooth(method="lm", formula=y~e^(x), col="black", lwd=1.5, se=FALSE)+
scale_x_continuous(name = "Time from Admission (Years)") +
scale_y_continuous(name = "Rasch-Scaled FIM Score (0-100)",limits=c(0,100)) +
theme_bw() +
theme(axis.text=element_text(size=14, colour="black"),
axis.title=element_text(size=14,face="bold")) +
theme(strip.text.x = element_text(size = 14))+ theme(legend.position="none")
# Negative Exponential Model ----
ggplot(DATA, aes(x = year.0, y = rasch_FIM)) +
geom_line(aes(group=subID), col="grey") +
stat_smooth(method="lm", formula=y~1^(x), col="black", lwd=1.5, se=FALSE)+
scale_x_continuous(name = "Time from Admission (Years)") +
scale_y_continuous(name = "Rasch-Scaled FIM Score (0-100)",limits=c(0,100)) +
theme_bw() +
theme(axis.text=element_text(size=14, colour="black"),
axis.title=element_text(size=14,face="bold")) +
theme(strip.text.x = element_text(size = 14))+ theme(legend.position="none")
# Negative Exponential Model ----
ggplot(DATA, aes(x = year.0, y = rasch_FIM)) +
geom_line(aes(group=subID), col="grey") +
stat_smooth(method="lm", formula=y~x, col="black", lwd=1.5, se=FALSE)+
scale_x_continuous(name = "Time from Admission (Years)") +
scale_y_continuous(name = "Rasch-Scaled FIM Score (0-100)",limits=c(0,100)) +
theme_bw() +
theme(axis.text=element_text(size=14, colour="black"),
axis.title=element_text(size=14,face="bold")) +
theme(strip.text.x = element_text(size = 14))+ theme(legend.position="none")
# Negative Exponential Model ----
ggplot(DATA, aes(x = year.0, y = rasch_FIM)) +
geom_line(aes(group=subID), col="grey") +
stat_smooth(method="lm", formula=y~1/(x^0.5), col="black", lwd=1.5, se=FALSE)+
scale_x_continuous(name = "Time from Admission (Years)") +
scale_y_continuous(name = "Rasch-Scaled FIM Score (0-100)",limits=c(0,100)) +
theme_bw() +
theme(axis.text=element_text(size=14, colour="black"),
axis.title=element_text(size=14,face="bold")) +
theme(strip.text.x = element_text(size = 14))+ theme(legend.position="none")
# Negative Exponential Model ----
ggplot(DATA, aes(x = year.0, y = rasch_FIM)) +
geom_line(aes(group=subID), col="grey") +
stat_smooth(method="lm", formula=y~1/(x^2), col="black", lwd=1.5, se=FALSE)+
scale_x_continuous(name = "Time from Admission (Years)") +
scale_y_continuous(name = "Rasch-Scaled FIM Score (0-100)",limits=c(0,100)) +
theme_bw() +
theme(axis.text=element_text(size=14, colour="black"),
axis.title=element_text(size=14,face="bold")) +
theme(strip.text.x = element_text(size = 14))+ theme(legend.position="none")
# Negative Exponential Model ----
ggplot(DATA, aes(x = year.0, y = rasch_FIM)) +
geom_line(aes(group=subID), col="grey") +
stat_smooth(method="lm", formula=y~1/(x+x^2), col="black", lwd=1.5, se=FALSE)+
scale_x_continuous(name = "Time from Admission (Years)") +
scale_y_continuous(name = "Rasch-Scaled FIM Score (0-100)",limits=c(0,100)) +
theme_bw() +
theme(axis.text=element_text(size=14, colour="black"),
axis.title=element_text(size=14,face="bold")) +
theme(strip.text.x = element_text(size = 14))+ theme(legend.position="none")
# Negative Exponential Model ----
ggplot(DATA, aes(x = year.0, y = rasch_FIM)) +
geom_line(aes(group=subID), col="grey") +
stat_smooth(method="lm", formula=y~x+x^2, col="black", lwd=1.5, se=FALSE)+
scale_x_continuous(name = "Time from Admission (Years)") +
scale_y_continuous(name = "Rasch-Scaled FIM Score (0-100)",limits=c(0,100)) +
theme_bw() +
theme(axis.text=element_text(size=14, colour="black"),
axis.title=element_text(size=14,face="bold")) +
theme(strip.text.x = element_text(size = 14))+ theme(legend.position="none")
# Negative Exponential Model ----
ggplot(DATA, aes(x = year.0, y = rasch_FIM)) +
geom_line(aes(group=subID), col="grey") +
stat_smooth(method="lm", formula=y~x+I(x^2), col="black", lwd=1.5, se=FALSE)+
scale_x_continuous(name = "Time from Admission (Years)") +
scale_y_continuous(name = "Rasch-Scaled FIM Score (0-100)",limits=c(0,100)) +
theme_bw() +
theme(axis.text=element_text(size=14, colour="black"),
axis.title=element_text(size=14,face="bold")) +
theme(strip.text.x = element_text(size = 14))+ theme(legend.position="none")
set.seed(100)
neg_exp_rand_mod <- nlme(rasch_FIM ~ b_1 +
(b_2i)*(exp(b_3i * year.0)),
data = DATA,
fixed = b_1 + b_2i + b_3i ~ 1,
random = list(b_2i ~ 1, b_3i ~1),
groups = ~ subID,
start = c(80, -70, -1),
na.action = na.omit)
summary(neg_exp_rand_mod)
x <- seq(from=0, to=1.5, by=0.1)
x <- seq(from=0, to=1.5, by=0.05)
x <- seq(from=0, to=1.6, by=0.05)
y <- 73.15-56.65*e^(-1.25*x)
y <- 73.15-56.65*exp(-1.25*x)
plot(y, x)
plot(x, y)
plot(x, y, type=l)
plot(x, y, type="l")
# Negative Exponential Model ----
ggplot(DATA, aes(x = year.0, y = rasch_FIM)) +
geom_line(aes(group=subID), col="grey") +
stat_smooth(method="lm", formula=y~x+I(x^2), col="black", lwd=1.5, se=FALSE)+
scale_x_continuous(name = "Time from Admission (Years)") +
scale_y_continuous(name = "Rasch-Scaled FIM Score (0-100)",limits=c(0,100)) +
theme_bw() +
theme(axis.text=element_text(size=14, colour="black"),
axis.title=element_text(size=14,face="bold")) +
theme(strip.text.x = element_text(size = 14))+ theme(legend.position="none")
year.0 <- seq(from=0, to=1.6, by=0.05)
rasch_FIM <- 73.15-56.65*exp(-1.25*x)
PRED <- data.frame(year.0, rasch_FIM)
ggplot(DATA, aes(x = year.0, y = rasch_FIM)) +
geom_line(aes(group=subID), col="grey") +
geom_line(data=PRED, col="black", lwd=1) +
scale_x_continuous(name = "Time from Admission (Years)") +
scale_y_continuous(name = "Independence (0-100)",limits=c(0,100)) +
theme_bw() +
theme(axis.text=element_text(size=14, colour="black"),
axis.title=element_text(size=14,face="bold")) +
theme(strip.text.x = element_text(size = 14))+ theme(legend.position="none")
coefs(neg_exp_rand_mod)
coef(neg_exp_rand_mod)
fitted(neg_exp_rand_mod)
first4<-DATA[c(1:72),] # Second, we'll make a smaller dataset with the predictions for these 10:
ggplot(first4, aes(x = year.0, y = rasch_FIM)) +
geom_line(aes(group=subID)) + facet_wrap(~subID, ncol=5)+
geom_point(fill="grey", pch=21, size=2, stroke=1.25) +
scale_x_continuous(name = "Time from Admission (Years)") +
scale_y_continuous(name = "Independence (0-100)",limits=c(0,100))+
geom_line(aes(y=exp_pred), lwd=1, col="purple") +
theme_bw() + theme(axis.text=element_text(size=10, colour="black"),
axis.title=element_text(size=10,face="bold")) +
theme(strip.text.x = element_text(size = 10))+ theme(legend.position="none")
DATA$exp_pred <- fitted(neg_exp_rand_mod) # Save model predictions to data frame
first4<-DATA[c(1:72),] # Second, we'll make a smaller dataset with the predictions for these 10:
ggplot(first4, aes(x = year.0, y = rasch_FIM)) +
geom_line(aes(group=subID)) + facet_wrap(~subID, ncol=5)+
geom_point(fill="grey", pch=21, size=2, stroke=1.25) +
scale_x_continuous(name = "Time from Admission (Years)") +
scale_y_continuous(name = "Independence (0-100)",limits=c(0,100))+
geom_line(aes(y=exp_pred), lwd=1, col="purple") +
theme_bw() + theme(axis.text=element_text(size=10, colour="black"),
axis.title=element_text(size=10,face="bold")) +
theme(strip.text.x = element_text(size = 10))+ theme(legend.position="none")
ggplot(first4, aes(x = year.0, y = rasch_FIM)) +
geom_line(aes(group=subID)) + facet_wrap(~subID, ncol=2)+
geom_point(fill="grey", pch=21, size=2, stroke=1.25) +
scale_x_continuous(name = "Time from Admission (Years)") +
scale_y_continuous(name = "Independence (0-100)",limits=c(0,100))+
geom_line(aes(y=exp_pred), lwd=1, col="purple") +
theme_bw() + theme(axis.text=element_text(size=10, colour="black"),
axis.title=element_text(size=10,face="bold")) +
theme(strip.text.x = element_text(size = 10))+ theme(legend.position="none")
coef(neg_exp_rand_mod)
set.seed(100)
neg_exp_rand_mod <- nlme(rasch_FIM ~ b_1i +
(b_2i)*(exp(b_3i * year.0)),
data = DATA,
fixed = b_1 + b_2i + b_3i ~ 1,
random = list(b_1i ~ 1, b_2i ~ 1, b_3i ~1),
groups = ~ subID,
start = c(80, -70, -1),
na.action = na.omit)
neg_exp_rand_mod <- nlme(rasch_FIM ~ b_1i +
(b_2i)*(exp(b_3i * year.0)),
data = DATA,
fixed = b_1i + b_2i + b_3i ~ 1,
random = list(b_1i ~ 1, b_2i ~ 1, b_3i ~1),
groups = ~ subID,
start = c(80, -70, -1),
na.action = na.omit)
summary(neg_exp_rand_mod)
set.seed(100)
neg_exp_rand_mod <- nlme(rasch_FIM ~ b_1i +
(b_2i)*(exp(b_3i * year.0)),
data = DATA,
fixed = b_1i + b_2i + b_3i ~ 1,
random = list(b_1i ~ 1, b_2i ~ 1, b_3i ~1),
groups = ~ subID,
start = c(80, -70, -1),
na.action = na.omit)
summary(neg_exp_rand_mod)
coef(neg_exp_rand_mod)
fitted(neg_exp_rand_mod)
DATA$exp_pred <- fitted(neg_exp_rand_mod) # Save model predictions to data frame
first4<-DATA[c(1:72),] # Second, we'll make a smaller dataset with the predictions for these 10:
ggplot(first4, aes(x = year.0, y = rasch_FIM)) +
geom_line(aes(group=subID)) + facet_wrap(~subID, ncol=2)+
geom_point(fill="grey", pch=21, size=2, stroke=1.25) +
scale_x_continuous(name = "Time from Admission (Years)") +
scale_y_continuous(name = "Independence (0-100)",limits=c(0,100))+
geom_line(aes(y=exp_pred), lwd=1, col="purple") +
theme_bw() + theme(axis.text=element_text(size=10, colour="black"),
axis.title=element_text(size=10,face="bold")) +
theme(strip.text.x = element_text(size = 10))+ theme(legend.position="none")
ggplot(first4, aes(x = year.0, y = rasch_FIM)) +
geom_line(aes(group=subID)) + facet_wrap(~subID, ncol=2)+
geom_point(fill="grey", pch=21, size=2, stroke=1.25) +
scale_x_continuous(name = "Time from Admission (Years)") +
scale_y_continuous(name = "Independence (0-100)",limits=c(0,100))+
geom_line(aes(y=exp_pred), lwd=1, col="purple") +
theme_bw() + theme(axis.text=element_text(size=12, colour="black"),
axis.title=element_text(size=14,face="bold")) +
theme(strip.text.x = element_text(size = 12))+ theme(legend.position="none")
coef(neg_exp_rand_mod)
summary(neg_exp_rand_mod)
coef(neg_exp_rand_mod)
ggplot(DATA, aes(x = year, y = rasch_FIM)) +
geom_line(aes(group=subID), col="grey") +
scale_x_continuous(name = "Time from Admission (Years)") +
scale_y_continuous(name = "Rasch-Scaled FIM Score (0-100)",limits=c(0,100)) +
facet_wrap(~AIS_grade) +
theme_bw() +
theme(axis.text=element_text(size=14, colour="black"),
axis.title=element_text(size=14,face="bold")) +
theme(strip.text.x = element_text(size = 14))+ theme(legend.position="none") +
geom_line(data=MEAN, aes(x=year, y=rasch_FIM, lty=AIS_grade), col="black", lwd=1.5)
year <- seq(from=0, to=1.5, by=0.01)
r
summary(neg_exp_rand_mod)
rasch_FIM <- 58.53985-48.13958*exp(-2.53036*year)
PRED <- data.frame(year, rasch_FIM)
ggplot(DATA, aes(x = year, y = rasch_FIM)) +
geom_line(aes(group=subID), col="grey") +
scale_x_continuous(name = "Time from Admission (Years)") +
scale_y_continuous(name = "Rasch-Scaled FIM Score (0-100)",limits=c(0,100)) +
facet_wrap(~AIS_grade) +
theme_bw() +
theme(axis.text=element_text(size=14, colour="black"),
axis.title=element_text(size=14,face="bold")) +
theme(strip.text.x = element_text(size = 14))+ theme(legend.position="none") +
geom_line(data=PRED, aes(x=year, y=rasch_FIM, lty=AIS_grade), col="black", lwd=1.5)
ggplot(DATA, aes(x = year, y = rasch_FIM)) +
geom_line(aes(group=subID), col="grey") +
scale_x_continuous(name = "Time from Admission (Years)") +
scale_y_continuous(name = "Rasch-Scaled FIM Score (0-100)",limits=c(0,100)) +
facet_wrap(~AIS_grade) +
theme_bw() +
theme(axis.text=element_text(size=14, colour="black"),
axis.title=element_text(size=14,face="bold")) +
theme(strip.text.x = element_text(size = 14))+ theme(legend.position="none")
head(DATA)
ggplot(DATA, aes(x = time, y = rasch_FIM)) +
geom_line(aes(group=subID), col="grey") +
scale_x_continuous(name = "Time from Admission (Years)") +
scale_y_continuous(name = "Rasch-Scaled FIM Score (0-100)",limits=c(0,100)) +
facet_wrap(~AIS_grade) +
theme_bw() +
theme(axis.text=element_text(size=14, colour="black"),
axis.title=element_text(size=14,face="bold")) +
theme(strip.text.x = element_text(size = 14))+ theme(legend.position="none")
ggplot(DATA, aes(x = time, y = rasch_FIM)) +
geom_line(aes(group=subID), col="grey") +
scale_x_continuous(name = "Time from Admission (Years)") +
scale_y_continuous(name = "Rasch-Scaled FIM Score (0-100)",limits=c(0,100)) +
#facet_wrap(~AIS_grade) +
theme_bw() +
theme(axis.text=element_text(size=14, colour="black"),
axis.title=element_text(size=14,face="bold")) +
theme(strip.text.x = element_text(size = 14))+ theme(legend.position="none")
ggplot(DATA, aes(x = time, y = rasch_FIM)) +
geom_line(aes(group=subID), col="grey") +
scale_x_continuous(name = "Time from Admission (Years)") +
scale_y_continuous(name = "Rasch-Scaled FIM Score (0-100)",limits=c(0,100)) +
#facet_wrap(~AIS_grade) +
theme_bw() +
theme(axis.text=element_text(size=14, colour="black"),
axis.title=element_text(size=14,face="bold")) +
theme(strip.text.x = element_text(size = 14))+ theme(legend.position="none")+
geom_line(data=PRED, aes(x=year, y=rasch_FIM, lty=AIS_grade), col="black", lwd=1.5)
ggplot(DATA, aes(x = time, y = rasch_FIM)) +
geom_line(aes(group=subID), col="grey") +
scale_x_continuous(name = "Time from Admission (Years)") +
scale_y_continuous(name = "Rasch-Scaled FIM Score (0-100)",limits=c(0,100)) +
#facet_wrap(~AIS_grade) +
theme_bw() +
theme(axis.text=element_text(size=14, colour="black"),
axis.title=element_text(size=14,face="bold")) +
theme(strip.text.x = element_text(size = 14))+ theme(legend.position="none")+
geom_line(data=PRED, aes(x=year, y=rasch_FIM), col="black", lwd=1.5)
ggplot(DATA, aes(x = year.0, y = rasch_FIM)) +
geom_line(aes(group=subID), col="grey") +
scale_x_continuous(name = "Time from Admission (Years)") +
scale_y_continuous(name = "Rasch-Scaled FIM Score (0-100)",limits=c(0,100)) +
#facet_wrap(~AIS_grade) +
theme_bw() +
theme(axis.text=element_text(size=14, colour="black"),
axis.title=element_text(size=14,face="bold")) +
theme(strip.text.x = element_text(size = 14))+ theme(legend.position="none")+
geom_line(data=PRED, aes(x=year, y=rasch_FIM), col="black", lwd=1.5)
ggplot(DATA, aes(x = year.0, y = rasch_FIM)) +
geom_line(aes(group=subID), col="grey") +
scale_x_continuous(name = "Time from Admission (Years)") +
scale_y_continuous(name = "Independence (0-100)",limits=c(0,100)) +
#facet_wrap(~AIS_grade) +
theme_bw() +
theme(axis.text=element_text(size=14, colour="black"),
axis.title=element_text(size=14,face="bold")) +
theme(strip.text.x = element_text(size = 14))+ theme(legend.position="none")+
geom_line(data=PRED, aes(x=year, y=rasch_FIM), col="black", lwd=1.5)
library("tidyverse"); library("lubridate")
getwd()
setwd("~/GitHub/accelerometry_R01/")
list.files()
TIMES <- read.csv("./Aim1_Timestamp_20220505_KRL.csv", sep=",",
stringsAsFactors = TRUE)
head(TIMES)
?I()
# Survey 1: 6 Month Survey Questions (Columns D-K) ----
SURVEY1_LONG <- TIMES %>%
select(record_id,
datetime_hx_start_6,
datetimepage2_stop_6,
datetime_hx_stop_6,
datetime_ibqr_stop_6,
datetime_ismq_stop_6,
datetime_irbs_stop_6,
datetime_agestage_stop_6,
datetime_cg1_hx_start_6,
datetime_cg1_hx_stop_6) %>%
pivot_longer(!record_id, names_to="Event", values_to = "Time")
library(car); library(patchwork); library(ez)
library(ggExtra); library(mediation); library(tidyverse)
getwd()
setwd("~/GitHub/taylor_2022_CI_sequential_effects")
list.files("./Data/")
# 1.0 Visualizing Data ---------------------------------------------------------
ACQ<-read.csv("./Data/data_ACQ_MASTER.csv", header = TRUE, sep=",",
na.strings=c("NA","NaN"," ",""), stringsAsFactors = TRUE)
head(ACQ)
ACQ$participant <-factor(ACQ$participant)
ACQ$Target<-factor(ACQ$target)
ACQ$block <- factor(ACQ$block)
scale(ACQ$hold_time)
scale(ACQ$hold_time)[,1]
mean(scale(ACQ$hold_time))
(scale(ACQ$hold_time))^2
I(scale(ACQ$hold_time))^2
plot((scale(ACQ$hold_time))^2)
hist((scale(ACQ$hold_time))^2)
hist((scale(ACQ$hold_time)[,1])^2)
scale(ACQ$hold_time)[,1]
hist(scale(ACQ$hold_time)[,1])
# Removing Outliers
ACQ$absolute_error <- ifelse(ACQ$absolute_error < 1000, ACQ$absolute_error, NA)
ACQ$constant_error <- ifelse(ACQ$absolute_error < 1000, ACQ$constant_error, NA)
ACQ$hold_time <- ifelse(ACQ$absolute_error < 1000, ACQ$hold_time, NA)
hist(scale(ACQ$hold_time)[,1])
hist(scale(ACQ$hold_time))
hist(scale(ACQ$hold_time)^2)
str(scale(ACQ$hold_time))
