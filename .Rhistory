BLOCK_COR_MAT <- apply(BLOCK_ARRAY, 1:2, mean)
colnames(BLOCK_COR_MAT) <- paste0("N",seq(0:4)-1)
rownames(BLOCK_COR_MAT) <- paste0("N",seq(0:4)-1)
BLOCK_COR_MAT
# Multilevel Model Approach to Change ----
head(ACQ3)
ggplot(ACQ3[ACQ3$participant==105,],
aes(x =target_lag_constant_error, y = constant_error)) +
geom_line() +
geom_point(shape=16) +
scale_x_continuous(name = expression(bold(Constant~Error~n[k]~(s))), limits=c(-1,1)) +
scale_y_continuous(name = expression(bold(Change~AE~n[k]+1~(s))), limits=c(-1,1)) +
theme_bw()+
theme(axis.text=element_text(size=12, color="black"),
legend.text=element_text(size=12, color="black"),
legend.title=element_text(size=12, face="bold"),
axis.title=element_text(size=12, face="bold"),
plot.title=element_text(size=12, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=12, face="bold"),
legend.position = "bottom")
library(lme4); library(lmerTest)
target_mod_CE <- lmer(constant_error~
# Fixed Effects
group*target_lag_constant_error+
group*target_lag_2_constant_error+
group*target_lag_3_constant_error+
group*target_lag_4_constant_error+
# Random Effects
(1+target_lag_constant_error+
target_lag_2_constant_error+
target_lag_3_constant_error+
target_lag_4_constant_error|participant)+
(1|block),
data=ACQ_by_TARGET, REML=FALSE,
control=lmerControl(optimizer="bobyqa",optCtrl=list(maxfun=5e5)))
summary(target_mod_CE)
anova(target_mod_CE)
target_mod_AE <- lmer(absolute_error~
# Fixed Effects
group*target_lag_constant_error+
group*I(target_lag_constant_error^2)+
# Random Effects
(1+target_lag_constant_error+
I(target_lag_constant_error^2)|participant)+
(1|block)+(1|Target),
data=ACQ_by_TARGET, REML=FALSE,
control=lmerControl(optimizer="bobyqa",optCtrl=list(maxfun=5e5)))
summary(target_mod_AE)
anova(target_mod_AE)
lag1_error <- c(rep(seq(from=-1, to=1, by=0.1),2))
group <- c(rep("Blocked", 21), rep("Random", 21))
phase <- c(rep("Target", 42))
pred_CE <-ifelse(group=="Blocked",
-1.863e-04+3.866e-02*lag1_error,
(-1.863e-04+1.801e-02)+(3.866e-02+7.505e-02)*lag1_error)
pred_AE <-ifelse(group=="Blocked",
0.142482+0.007441*lag1_error+0.225396*I(lag1_error^2),
(0.142482+0.032299)+
(0.007441+0.018580)*lag1_error+
(0.225396-0.084151)*I(lag1_error^2))
TARGET_PRED_DATA <- data.frame(group, phase, lag1_error,
pred_CE, pred_AE)
summary(TARGET_PRED_DATA)
head(TARGET_PRED_DATA)
ggplot(TARGET_PRED_DATA, aes(x =lag1_error, y = pred_CE)) +
geom_line(aes(col=group), lwd=1.5) +
scale_x_continuous(limits=c(-1,1))
summary(ACQ_by_TARGET$constant_error)
# Trial Models
trial_mod_CE <- lmer(constant_error~
# Fixed Effects
group*trial_lag_constant_error+
group*trial_lag_2_constant_error+
group*trial_lag_3_constant_error+
group*trial_lag_4_constant_error+
# Random Effects
(1+trial_lag_constant_error+
trial_lag_2_constant_error+
trial_lag_3_constant_error+
trial_lag_4_constant_error|participant)+
(1|block),
data=ACQ_by_TRIAL, REML=FALSE,
control=lmerControl(optimizer="bobyqa",optCtrl=list(maxfun=5e5)))
summary(trial_mod_CE)
anova(trial_mod_CE)
trial_mod_AE <- lmer(absolute_error~
# Fixed Effects
group*trial_lag_constant_error+
group*I(trial_lag_constant_error^2)+
# Random Effects
(1+trial_lag_constant_error+
I(trial_lag_constant_error^2)|participant)+
(1|block)+(1|Target),
data=ACQ_by_TRIAL, REML=FALSE,
control=lmerControl(optimizer="bobyqa",optCtrl=list(maxfun=5e5)))
summary(trial_mod_AE)
anova(trial_mod_AE)
lag1_error <- c(rep(seq(from=-1, to=1, by=0.1),2))
group <- c(rep("Blocked", 21), rep("Random", 21))
phase <- c(rep("Trial", 42))
pred_CE <-ifelse(group=="Blocked",
-0.001718+0.037837*lag1_error,
(-0.001718+0.024816)+(0.037837-0.001376)*lag1_error)
pred_AE <-ifelse(group=="Blocked",
0.1437246+0.0076990*lag1_error+0.2171921*I(lag1_error^2),
(0.1437246+0.0337704)+
(0.0076990-0.0005079)*lag1_error+
(0.2171921-0.1076113)*I(lag1_error^2))
TRIAL_PRED_DATA <- data.frame(group, phase, lag1_error,
pred_CE, pred_AE)
summary(TRIAL_PRED_DATA)
head(TRIAL_PRED_DATA)
ggplot(TRIAL_PRED_DATA, aes(x =lag1_error, y = pred_CE)) +
geom_line(aes(col=group), lwd=1.5) +
scale_x_continuous(limits=c(-1,1))
PRED_DATA <- rbind(TARGET_PRED_DATA, TRIAL_PRED_DATA)
head(PRED_DATA)
ggplot(PRED_DATA, aes(x =lag1_error, y = pred_CE)) +
geom_line(aes(lty=phase, col=group), lwd=1.5) +
facet_wrap(~phase)+
scale_x_continuous(name = expression(bold(Constant~Error~n[k]-1~(s))), limits=c(-1,1)) +
scale_y_continuous(name = expression(bold(Constant~Error~n[k]~(s)))) +
theme_bw()+
scale_color_manual(values=c("black", "firebrick"))+
labs(col="Group", lty="Phase")+
theme(axis.text=element_text(size=12, color="black"),
legend.text=element_text(size=12, color="black"),
axis.title=element_text(size=12, face="bold"),
plot.title=element_text(size=12, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=12, face="bold"),
legend.title=element_blank(),
legend.position = "bottom")
ggplot(PRED_DATA, aes(x =lag1_error, y = pred_AE)) +
geom_line(aes(lty=phase, col=group), lwd=1.5) +
facet_wrap(~phase)+
scale_x_continuous(name = expression(bold(Constant~Error~n[k]-1~(s))), limits=c(-1,1)) +
scale_y_continuous(name = expression(bold(Absolute~Error~n[k]~(s)))) +
theme_bw()+
scale_color_manual(values=c("black", "firebrick"))+
labs(col="Group", lty="Phase")+
theme(axis.text=element_text(size=12, color="black"),
legend.text=element_text(size=12, color="black"),
axis.title=element_text(size=12, face="bold"),
plot.title=element_text(size=12, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=12, face="bold"),
legend.title=element_blank(),
legend.position = "bottom")
# 4.0 Correlations with long-term learning ----
# Contrast coding group and det_target
MERGED$rand.c <-as.numeric(MERGED$group)-1.5
MERGED$det_Target.c <- MERGED$det_Target - mean(MERGED$det_Target)
# Y ~ X
mod1 <- lm(ave_ae_Retention~rand.c,
data=MERGED)
summary(mod1)
#plot(mod1)
# M ~ X
mod2 <- lm(det_Target~rand.c,
data=MERGED)
summary(mod2)
#plot(mod2)
# Y ~ X + M
mod3 <- lm(ave_ae_Retention~rand.c*det_Target.c,
data=MERGED)
summary(mod3)
vif(mod3)
#plot(mod3)
head(MERGED)
ggplot(MERGED, aes(x = det_Target , y = ave_ae_Retention)) +
geom_point(aes(fill=group), shape=21)+
stat_smooth(aes(group=group, col=group), method="lm", se=FALSE) +
scale_color_manual(values=c("black", "firebrick"))+
scale_fill_manual(values=c("black", "red"))+
labs(col="Group", fill="Group")+
scale_x_continuous(name = "Determinant over Five Trials") +
scale_y_continuous(name = "Average Retention AE (s)", limits = c(0,1)) +
theme_bw()+
theme(axis.text=element_text(size=12, color="black"),
legend.text=element_text(size=12, color="black"),
axis.title=element_text(size=12, face="bold"),
plot.title=element_text(size=12, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=12, face="bold"),
legend.title=element_blank(),
legend.position = "bottom")
# Mediation Analysis: AE on Transfer ------------------------------------------
# Y ~ X
mod1 <- lm(ave_ae_Transfer~rand.c,
data=MERGED)
summary(mod1)
#plot(mod1)
# M ~ X
mod2 <- lm(det_Target~rand.c,
data=MERGED)
summary(mod2)
#plot(mod2)
# Y ~ X + M
mod3 <- lm(ave_ae_Transfer~rand.c*det_Target.c,
data=MERGED)
summary(mod3)
vif(mod3)
#plot(mod3)
head(MERGED)
ggplot(MERGED, aes(x = det_Target , y = ave_ae_Transfer)) +
geom_point(aes(col=group), shape=16)+
stat_smooth(aes(group=group, col=group), method="lm", se=FALSE) +
scale_color_manual(values=c("black", "firebrick"))+
scale_fill_manual(values=c("black", "red"))+
labs(col="Group", fill="Group")+
scale_x_continuous(name = "Determinant over Five Trials") +
scale_y_continuous(name = "Average Tranfer AE (s)", limits = c(0,1)) +
theme_bw()+
theme(axis.text=element_text(size=12, color="black"),
legend.text=element_text(size=12, color="black"),
axis.title=element_text(size=12, face="bold"),
plot.title=element_text(size=12, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=12, face="bold"),
legend.title=element_blank(),
legend.position = "bottom")
# 5.0. Correlations with Effort/Estimation Accuracy ----------------------------
head(ACQ3)
EEM <- ACQ3 %>% group_by(participant) %>% summarize(EEM = mean(error_estimate_AE, na.rm=TRUE))
head(MERGED)
MERGED <- merge(MERGED, EEM, by="participant")
head(MERGED)
ggplot(MERGED, aes(x = det_Target , y = EEM)) +
geom_point(aes(col=group), shape=16)+
stat_smooth(aes(group=group, col=group), method="lm", se=FALSE) +
scale_color_manual(values=c("black", "firebrick"))+
scale_fill_manual(values=c("black", "red"))+
labs(col="Group", fill="Group")+
scale_x_continuous(name = "Determinant over Five Trials") +
scale_y_continuous(name = "Error Estimation Mismatch") +
theme_bw()+
theme(axis.text=element_text(size=12, color="black"),
legend.text=element_text(size=12, color="black"),
axis.title=element_text(size=12, face="bold"),
plot.title=element_text(size=12, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=12, face="bold"),
legend.title=element_blank(),
legend.position = "bottom")
# Y ~ X
mod1 <- lm(EEM~rand.c,
data=MERGED)
summary(mod1)
#plot(mod1)
# M ~ X
mod2 <- lm(det_Target~rand.c,
data=MERGED)
summary(mod2)
#plot(mod2)
# Y ~ X + M
mod3 <- lm(EEM~rand.c*det_Target.c,
data=MERGED)
summary(mod3)
vif(mod3)
# RSME
list.files("./Data/")
RSME<-read.csv("./Data/data_RSME.csv", header = TRUE, sep=",",
na.strings=c("NA","NaN"," ",""), stringsAsFactors = TRUE)
head(RSME)
MERGED <- merge(MERGED, RSME[, c("participant", "ME_AVE")], by="participant")
head(MERGED)
ggplot(MERGED, aes(x = det_Target , y = ME_AVE)) +
geom_point(aes(col=group), shape=16)+
stat_smooth(aes(group=group, col=group), method="lm", se=FALSE) +
scale_color_manual(values=c("black", "firebrick"))+
scale_fill_manual(values=c("black", "red"))+
labs(col="Group", fill="Group")+
scale_x_continuous(name = "Determinant over Five Trials") +
scale_y_continuous(name = "Average Mental Effort (RSME)") +
theme_bw()+
theme(axis.text=element_text(size=12, color="black"),
legend.text=element_text(size=12, color="black"),
axis.title=element_text(size=12, face="bold"),
plot.title=element_text(size=12, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=12, face="bold"),
legend.title=element_blank(),
legend.position = "bottom")
# Y ~ X
mod1 <- lm(ME_AVE~rand.c,
data=MERGED)
summary(mod1)
#plot(mod1)
# M ~ X
mod2 <- lm(ME_AVE~rand.c,
data=MERGED)
summary(mod2)
#plot(mod2)
# Y ~ X + M
mod3 <- lm(ME_AVE~rand.c*det_Target.c,
data=MERGED)
summary(mod3)
vif(mod3)
ggplot(MERGED, aes(x = det_Target , y = EEM)) +
geom_point(aes(col=group), shape=16)+
stat_smooth(aes(group=group, col=group), method="lm", se=FALSE) +
scale_color_manual(values=c("black", "firebrick"))+
scale_fill_manual(values=c("black", "red"))+
labs(col="Group", fill="Group")+
scale_x_continuous(name = "Determinant over Five Trials") +
scale_y_continuous(name = "Error Estimation Mismatch") +
theme_bw()+
theme(axis.text=element_text(size=12, color="black"),
legend.text=element_text(size=12, color="black"),
axis.title=element_text(size=12, face="bold"),
plot.title=element_text(size=12, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=12, face="bold"),
legend.title=element_blank(),
legend.position = "bottom")
ggplot(MERGED, aes(x = det_Target , y = ME_AVE)) +
geom_point(aes(col=group), shape=16)+
stat_smooth(aes(group=group, col=group), method="lm", se=FALSE) +
scale_color_manual(values=c("black", "firebrick"))+
scale_fill_manual(values=c("black", "red"))+
labs(col="Group", fill="Group")+
scale_x_continuous(name = "Determinant over Five Trials") +
scale_y_continuous(name = "Average Mental Effort (RSME)") +
theme_bw()+
theme(axis.text=element_text(size=12, color="black"),
legend.text=element_text(size=12, color="black"),
axis.title=element_text(size=12, face="bold"),
plot.title=element_text(size=12, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=12, face="bold"),
legend.title=element_blank(),
legend.position = "bottom")
head(MERGED)
ggplot(MERGED, aes(x = det_Target , y = ave_ae_Retention)) +
geom_point(aes(fill=group), shape=21)+
stat_smooth(aes(group=group, col=group), method="lm", se=FALSE) +
scale_color_manual(values=c("black", "firebrick"))+
scale_fill_manual(values=c("black", "red"))+
labs(col="Group", fill="Group")+
scale_x_continuous(name = "Determinant over Five Trials") +
scale_y_continuous(name = "Average Retention AE (s)", limits = c(0,1)) +
theme_bw()+
theme(axis.text=element_text(size=12, color="black"),
legend.text=element_text(size=12, color="black"),
axis.title=element_text(size=12, face="bold"),
plot.title=element_text(size=12, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=12, face="bold"),
legend.title=element_blank(),
legend.position = "bottom")
# Y ~ X + M
mod3 <- lm(ME_AVE~rand.c*det_Target.c,
data=MERGED)
summary(mod3)
vif(mod3)
# Y ~ X + M
mod3 <- lm(ME_AVE~rand.c+det_Target.c,
data=MERGED)
summary(mod3)
ggplot(MERGED, aes(x = det_Target , y = ME_AVE)) +
geom_point(aes(col=group), shape=16)+
stat_smooth(aes(group=group, col=group), method="lm", se=FALSE) +
scale_color_manual(values=c("black", "firebrick"))+
scale_fill_manual(values=c("black", "red"))+
labs(col="Group", fill="Group")+
scale_x_continuous(name = "Determinant over Five Trials") +
scale_y_continuous(name = "Average Mental Effort (RSME)") +
theme_bw()+
theme(axis.text=element_text(size=12, color="black"),
legend.text=element_text(size=12, color="black"),
axis.title=element_text(size=12, face="bold"),
plot.title=element_text(size=12, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=12, face="bold"),
legend.title=element_blank(),
legend.position = "bottom")
# Y ~ X + M
mod3 <- lm(EEM~rand.c+det_Target.c,
data=MERGED)
summary(mod3)
vif(mod3)
# Y ~ X + M
mod3 <- lm(ME_AVE~rand.c*det_Target.c,
data=MERGED)
summary(mod3)
head(EEM)
View(EEM)
# Y ~ X + M
mod3 <- lm(EEM~rand.c*det_Target.c,
data=MERGED)
summary(mod3)
# Y ~ X + M
mod3 <- lm(EEM~rand.c*det_Target.c,
data=MERGED)
summary(mod3)
vif(mod3)
ggplot(MERGED, aes(x = det_Target , y = EEM)) +
geom_point(aes(col=group), shape=16)+
stat_smooth(aes(group=group, col=group), method="lm", se=FALSE) +
scale_color_manual(values=c("black", "firebrick"))+
scale_fill_manual(values=c("black", "red"))+
labs(col="Group", fill="Group")+
scale_x_continuous(name = "Determinant over Five Trials") +
scale_y_continuous(name = "Error Estimation Mismatch") +
theme_bw()+
theme(axis.text=element_text(size=12, color="black"),
legend.text=element_text(size=12, color="black"),
axis.title=element_text(size=12, face="bold"),
plot.title=element_text(size=12, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=12, face="bold"),
legend.title=element_blank(),
legend.position = "bottom")
# Y ~ X + M
mod3 <- lm(EEM~rand.c*det_Target.c,
data=MERGED)
summary(mod3)
ggplot(PRED_DATA, aes(x =lag1_error, y = pred_AE)) +
geom_line(aes(lty=phase, col=group), lwd=1.5) +
facet_wrap(~phase)+
scale_x_continuous(name = expression(bold(Constant~Error~n[k]-1~(s))), limits=c(-1,1)) +
scale_y_continuous(name = expression(bold(Absolute~Error~n[k]~(s)))) +
theme_bw()+
scale_color_manual(values=c("black", "firebrick"))+
labs(col="Group", lty="Phase")+
theme(axis.text=element_text(size=12, color="black"),
legend.text=element_text(size=12, color="black"),
axis.title=element_text(size=12, face="bold"),
plot.title=element_text(size=12, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=12, face="bold"),
legend.title=element_blank(),
legend.position = "bottom")
# Y ~ X + M
mod3 <- lm(ave_ae_Retention~det_Target.c,
data=MERGED)
summary(mod3)
vif(mod3)
ggplot(MERGED, aes(x = det_Target , y = ave_ae_Retention)) +
geom_point(aes(fill=group), shape=21)+
stat_smooth(aes(group=group, col=group), method="lm", se=FALSE) +
scale_color_manual(values=c("black", "firebrick"))+
scale_fill_manual(values=c("black", "red"))+
labs(col="Group", fill="Group")+
scale_x_continuous(name = "Determinant over Five Trials") +
scale_y_continuous(name = "Average Retention AE (s)", limits = c(0,1)) +
theme_bw()+
theme(axis.text=element_text(size=12, color="black"),
legend.text=element_text(size=12, color="black"),
axis.title=element_text(size=12, face="bold"),
plot.title=element_text(size=12, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=12, face="bold"),
legend.title=element_blank(),
legend.position = "bottom")
# Y ~ X + M
mod3 <- lm(ave_ae_Retention~rand.c*det_Target.c,
data=MERGED)
summary(mod3)
vif(mod3)
head(MERGED)
ggplot(MERGED, aes(x = det_Target , y = ave_ae_Retention)) +
geom_point(aes(fill=group), shape=21)+
stat_smooth(aes(group=group, col=group), method="lm", se=FALSE) +
scale_color_manual(values=c("black", "firebrick"))+
scale_fill_manual(values=c("black", "red"))+
labs(col="Group", fill="Group")+
scale_x_continuous(name = "Determinant over Five Trials") +
scale_y_continuous(name = "Average Retention AE (s)", limits = c(0,1)) +
theme_bw()+
theme(axis.text=element_text(size=12, color="black"),
legend.text=element_text(size=12, color="black"),
axis.title=element_text(size=12, face="bold"),
plot.title=element_text(size=12, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=12, face="bold"),
legend.title=element_blank(),
legend.position = "bottom")
# Mediation Analysis: AE on Transfer ------------------------------------------
# Y ~ X
mod1 <- lm(ave_ae_Transfer~rand.c,
data=MERGED)
summary(mod1)
# M ~ X
mod2 <- lm(det_Target~rand.c,
data=MERGED)
summary(mod2)
# Y ~ X + M
mod3 <- lm(ave_ae_Transfer~rand.c*det_Target.c,
data=MERGED)
summary(mod3)
vif(mod3)
head(MERGED)
ggplot(MERGED, aes(x = det_Target , y = ave_ae_Transfer)) +
geom_point(aes(col=group), shape=16)+
stat_smooth(aes(group=group, col=group), method="lm", se=FALSE) +
scale_color_manual(values=c("black", "firebrick"))+
scale_fill_manual(values=c("black", "red"))+
labs(col="Group", fill="Group")+
scale_x_continuous(name = "Determinant over Five Trials") +
scale_y_continuous(name = "Average Tranfer AE (s)", limits = c(0,1)) +
theme_bw()+
theme(axis.text=element_text(size=12, color="black"),
legend.text=element_text(size=12, color="black"),
axis.title=element_text(size=12, face="bold"),
plot.title=element_text(size=12, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=12, face="bold"),
legend.title=element_blank(),
legend.position = "bottom")
